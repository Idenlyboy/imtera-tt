# Проект: Прототип работы с отзывами Яндекс.Карт

Документацию **API Яндекс.Карт** изучил, но подходящего решения не нашёл.  
Спросил у поддержки Яндекса — ответили, что инструментов для получения отзывов нет, максимум можно использовать **виджет с отзывами** (через "Поделиться" → "Виджет с отзывами").  

Использовать скрытые эндпоинты нельзя, так как они требуют `csrfToken`, `sessionId` и `reqId`.  

Вручную удалось получить ответ с отзывами от сервера (файл: `database/yandexResponse.json`).  
Поэтому был создан **прототип работы API Яндекса**, при этом оставлена возможность интеграции через реальный API, если в будущем появится официальный инструмент.

---

## Архитектура проекта

---

### Бэкенд

- **Технологии:** PHP, Laravel  
- **Паттерн:** MVC (Model-View-Controller)  
- **Структура:**
  - **Controllers** — обработка запросов и вызов бизнес-логики.
  - **Dto** — обработка запросов и вызов бизнес-логики.
  - **Exceptions** — кастомные ошибки для пробрасывания.
  - **Resources** — кастомные ресурсы для переиспользования.
  - **Requests** — Валидация запросов.
  - **Traits** — Полезные и удобные фичи.
  - **Services** — бизнес-логика.
  - **Models** — работа с базой данных, структура объектов, сущности.
  - **Views** — шаблоны Blade для серверной генерации страниц.
  - **Middleware** — управление доступом к эндпоинтам (`web.route.access`, `api.route.access`).  
- **Особенности:**
  - Реализован прототип API для работы с отзывами Яндекс.Карт.  
  - Возможность интеграции реального API в будущем.  

---

### Фронтенд

- **Технологии:** Vue 3 (Composition API), Pinia, TypeScript 
- **Архитектура:** FSD (Feature-Sliced Design)  
- **Структура:**
  - **entities/** — сущности приложения, например `subject`.  
  - **features/** — функциональные блоки с логикой.  
  - **shared/** — переиспользуемые компоненты, интерфейсы, утилиты.  
  - **pages/** — страницы приложения.  
  - **widgets/** — небольшие визуальные блоки с логикой.  

---

## Web-эндпоинты

### Регистрация пользователя
- **Метод:** `GET`  
- **URL:** `/reg`  
- **Описание:** Страница регистрации  

### Вход пользователя
- **Метод:** `GET`  
- **URL:** `/login`  
- **Описание:** Страница входа пользователя  

### Вход администратора
- **Метод:** `GET`  
- **URL:** `/admin/login`  
- **Описание:** Страница входа администратора  

### Главная страница
- **Метод:** `GET`  
- **URL:** `/`  
- **Описание:** Главная страница  
- **Middleware:** `web.route.access`

### Настройки пользователя
- **Метод:** `GET`  
- **URL:** `/settings`  
- **Описание:** Страница настроек пользователя  
- **Middleware:** `web.route.access`

---

## API-эндпоинты

### Авторизация пользователя
- **Метод:** `POST`  
- **URL:** `/login`  
- **Описание:** Авторизация пользователя  
- **Параметры (body):**
  - `email` — email пользователя  
  - `password` — пароль 

### Регистрация пользователя
- **Метод:** `POST`  
- **URL:** `/reg`  
- **Описание:** Регистрация нового пользователя  
- **Параметры (body):**
  - `name` — имя пользователя  
  - `email` — email  
  - `password` — пароль  

### Выход пользователя
- **Метод:** `POST`  
- **URL:** `/logout`  
- **Описание:** Завершение сессии пользователя  

### Получение отзывов по объекту
- **Метод:** `POST`  
- **URL:** `/subject/get-items/`  
- **Описание:** Возвращает список отзывов для заданного объекта  
- **Параметры (body):**
  - `url` — URL объекта на Яндекс.Картах  
  - `page` — номер страницы  
  - `per_page` — количество отзывов на странице  
- **Middleware:** `api.route.access`

### Создание нового объекта (subject)
- **Метод:** `POST`  
- **URL:** `/subject/`  
- **Описание:** Сохраняет новый объект  
- **Параметры (body):**
  - `subject` — объект с данными  
- **Middleware:** `api.route.access`

---

## Структура данных отзывов

Пример одного отзыва:

```json
{
  "reviewId": "okoywn0yvS2NNAvxOweHUsLUJ9NA8nF",
  "businessId": "1010501395",
  "author": {
    "name": "Михаил Греков",
    "avatarUrl": "https://avatars.mds.yandex.net/get-yapic/68143/0k-4/{size}",
    "professionLevel": "Знаток города 2 уровня",
    "isSubscribed": false
  },
  "text": "Текст отзыва пользователя",
  "rating": 3,
  "photos": [],
  "videos": [],
  "reactions": {
    "likes": 1,
    "dislikes": 1,
    "userReaction": "NONE"
  },
  "businessComment": {
    "text": "Ответ компании",
    "updatedTime": "2024-01-05T09:08:19.080Z"
  },
  "updatedTime": "2024-01-02T16:56:22.163Z"
}